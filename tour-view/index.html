---
layout: default
title: íˆ¬ì–´ ìƒì„¸ - DMC íˆ¬ì–´ë§í¬
---

<style>
.tv-wrap{max-width:var(--max-width);margin:0 auto;padding:32px 20px}
.tv-hero{width:100%;height:320px;border-radius:16px;overflow:hidden;margin-bottom:24px;background:linear-gradient(135deg,var(--navy),var(--navy-light));display:flex;align-items:center;justify-content:center;color:#fff;font-size:64px}
.tv-hero img{width:100%;height:100%;object-fit:cover}
.tv-title{font-size:28px;font-weight:900;color:var(--navy);margin-bottom:8px}
.tv-meta{font-size:14px;color:var(--gray-700);margin-bottom:24px}
.tv-section{margin-bottom:24px}
.tv-section h3{font-size:18px;font-weight:700;color:var(--navy);margin-bottom:12px;padding-bottom:8px;border-bottom:2px solid var(--gray-200)}
.tv-section ul{list-style:none;padding:0}
.tv-section li{padding:6px 0;font-size:14px;line-height:1.6;border-bottom:1px solid var(--gray-100)}
.tv-section li::before{content:'â€¢';color:var(--orange);font-weight:700;margin-right:8px}
.tv-section p{font-size:14px;line-height:1.7;color:var(--gray-900)}
.tv-price-box{background:var(--gray-50);border-radius:12px;padding:20px;text-align:center;margin-bottom:24px}
.tv-price{font-size:28px;font-weight:900;color:var(--orange)}
.tv-actions{display:flex;gap:12px;margin-top:16px;justify-content:center}
.tv-grid{display:grid;grid-template-columns:2fr 1fr;gap:32px}
.tv-itin-day{font-weight:700;color:var(--navy);margin-right:4px}
@media(max-width:768px){.tv-grid{grid-template-columns:1fr}.tv-hero{height:200px}}
</style>

<div class="tv-wrap">
  <a href="{{ '/' | relative_url }}" class="btn-back" style="display:inline-flex;align-items:center;gap:6px;padding:8px 16px;border:1px solid var(--gray-300);border-radius:8px;background:#fff;font-size:13px;font-weight:600;cursor:pointer;color:var(--gray-700);margin-bottom:16px;text-decoration:none">â† ëŒì•„ê°€ê¸°</a>
  <div id="tourViewContent"><p style="text-align:center;padding:60px;color:var(--gray-500)">ë¡œë”© ì¤‘...</p></div>
</div>

<script>
window.addEventListener('load', function(){
  var params = new URLSearchParams(window.location.search);
  var tourId = params.get('id');
  var container = document.getElementById('tourViewContent');
  if (!tourId) { container.innerHTML = '<p style="text-align:center;color:#c62828">íˆ¬ì–´ IDê°€ ì§€ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>'; return; }
  if (typeof db === 'undefined') { container.innerHTML = '<p style="text-align:center;color:#c62828">ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨</p>'; return; }

  db.collection('parsed_tours').doc(tourId).get().then(function(doc) {
    if (!doc.exists || doc.data().status !== 'approved') {
      container.innerHTML = '<p style="text-align:center;color:#c62828">íˆ¬ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ ì•„ì§ ìŠ¹ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>';
      return;
    }
    var d = doc.data();
    var name = d.title || d.tourName || '';
    var dest = (d.countryName||'') + (d.city ? ' Â· '+d.city : '') || d.destination || '';
    var imgUrl = d.imageUrl || (d.image && d.image.match(/^https?:\/\//) ? d.image : '');
    var heroContent = imgUrl ? '<img src="'+esc(imgUrl)+'" alt="">' : (d.image || 'ğŸŒ');
    var priceStr = d.priceFrom ? '$' + d.priceFrom + '~' : (d.price || 'ë¬¸ì˜');
    var dmcName = d.operatorName || d.dmcName || '';

    var html = '<div class="tv-hero">'+heroContent+'</div>';
    html += '<div class="tv-grid"><div>';
    html += '<h1 class="tv-title">' + esc(name) + '</h1>';
    html += '<div class="tv-meta">ğŸ“ ' + esc(dest) + ' Â· â±ï¸ ' + esc(d.duration||'') + (dmcName ? ' Â· ğŸ¢ '+esc(dmcName) : '') + '</div>';

    if (d.description) { html += '<div class="tv-section"><h3>ğŸ“ ì„¤ëª…</h3><p>' + esc(d.description) + '</p></div>'; }
    if (d.highlights && d.highlights.length) { html += renderList('âœ¨ í•˜ì´ë¼ì´íŠ¸', d.highlights); }
    if (d.itinerary && d.itinerary.length) {
      html += '<div class="tv-section"><h3>ğŸ“… ì¼ì •</h3><ul>';
      d.itinerary.forEach(function(item) {
        if (typeof item === 'object' && item.day) {
          html += '<li><span class="tv-itin-day">Day ' + item.day + ':</span> ' + esc(item.title || '') + (item.description ? ' - ' + esc(item.description) : '') + '</li>';
        } else {
          html += '<li>' + esc(String(item)) + '</li>';
        }
      });
      html += '</ul></div>';
    }
    if (d.included && d.included.length) { html += renderList('âœ… í¬í•¨ ì‚¬í•­', d.included); }
    if (d.excluded && d.excluded.length) { html += renderList('âŒ ë¶ˆí¬í•¨ ì‚¬í•­', d.excluded); }
    // legacy field names
    if (d.includes && d.includes.length && !d.included) { html += renderList('âœ… í¬í•¨ ì‚¬í•­', d.includes); }
    if (d.excludes && d.excludes.length && !d.excluded) { html += renderList('âŒ ë¶ˆí¬í•¨ ì‚¬í•­', d.excludes); }
    if (d.tags && d.tags.length) {
      html += '<div class="tv-section"><div style="display:flex;flex-wrap:wrap;gap:8px">';
      d.tags.forEach(function(tag){ html += '<span style="display:inline-block;padding:4px 12px;background:var(--gray-100);border-radius:20px;font-size:12px;color:var(--gray-700)">#'+esc(tag)+'</span>'; });
      html += '</div></div>';
    }

    html += '</div><div>';
    html += '<div class="tv-price-box"><div style="font-size:13px;color:var(--gray-700);margin-bottom:8px">1ì¸ ê°€ê²©</div>';
    html += '<div class="tv-price">' + esc(priceStr) + '</div>';
    if (d.duration) html += '<div style="font-size:13px;color:var(--gray-500);margin-top:4px">'+esc(d.duration)+'</div>';
    if (d.groupSize) html += '<div style="font-size:13px;color:var(--gray-500);margin-top:2px">ìµœëŒ€ '+d.groupSize+'ëª…</div>';
    if (d.languages && d.languages.length) html += '<div style="font-size:13px;color:var(--gray-500);margin-top:2px">ğŸ—£ï¸ '+esc(d.languages.join(', '))+'</div>';
    html += '<div class="tv-actions"><button class="btn btn-primary btn-lg" onclick="openInquiryForTour()">ğŸ’¬ ë¬¸ì˜í•˜ê¸°</button></div>';
    html += '</div>';
    if (dmcName) {
      html += '<div style="background:var(--gray-50);border-radius:12px;padding:16px;margin-top:16px;text-align:center">';
      html += '<div style="font-size:13px;color:var(--gray-500);margin-bottom:4px">ìš´ì˜ì‚¬</div>';
      html += '<div style="font-size:16px;font-weight:700;color:var(--navy)">'+esc(dmcName)+'</div>';
      html += '</div>';
    }
    html += '</div></div>';

    container.innerHTML = html;

    window.openInquiryForTour = function() {
      if (typeof InquirySystem !== 'undefined' && InquirySystem.openInquiryModal) {
        InquirySystem.openInquiryModal(name, dmcName);
      } else {
        alert('ë¬¸ì˜ ì‹œìŠ¤í…œì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      }
    };
  }).catch(function(e) {
    console.error('tour-view error:', e);
    container.innerHTML = '<p style="text-align:center;color:#c62828">íˆ¬ì–´ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>';
  });

  function renderList(title, items) {
    var h = '<div class="tv-section"><h3>'+title+'</h3><ul>';
    (Array.isArray(items)?items:[items]).forEach(function(i){ h += '<li>'+esc(typeof i === 'object' ? JSON.stringify(i) : String(i))+'</li>'; });
    return h + '</ul></div>';
  }
  function esc(s){if(!s)return'';var d=document.createElement('div');d.textContent=s;return d.innerHTML}
});
</script>
